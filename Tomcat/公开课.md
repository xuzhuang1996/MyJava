## 基础概念
### web 基础
1. 资源
   1. 静态资源：所有用户访问，得到的结果都一样。该类资源可直接被浏览器解析。如HTML、js、CSS、jpg
   2. 动态资源：每个用户访问相同的资源，得到的结果可能不一样。动态资源被访问后，需要先转换为静态资源，然后返回给浏览器解析。如servlet/jsp、PHP。
## Tomcat
### tomcat架构
1. Tomcat 的核心是两个组件：Connector 和 Container。

    <img src="https://github.com/xuzhuang1996/MyJava/blob/master/img/Tomcat/1.PNG" width=80% height=80% />
2. 连接器，称coyote。作为服务器提供给客户端访问的外部接口，客户端通过coyote与服务器建立连接、发送请求并接受响应。coyote封装了底层网络通信（socket请求以及响应处理），使得Catalina容器与具体的请求协议以及IO操作方式完全解耦。coyote将socket输入转换封装尾request对象，交给Catalina容器进行处理，处理完请求后，Catalina再通过coyote提供的response对象将结果写入输出流。

    <img src="https://github.com/xuzhuang1996/MyJava/blob/master/img/Tomcat/2.PNG" width=80% height=80% />
3. 连接器组件
   1. EndPoint,通信端点，即监听请求。
   2. Processor，将客户端发来的socket请求，转换为http请求，并对其进行解析，封装成request对象
   3. Adapter，在连接器与容器之间适配。将request转换为servletRequest对象，去调用容器中的方法。
   
     <img src="https://github.com/xuzhuang1996/MyJava/blob/master/img/Tomcat/3.PNG" width=80% height=80% />
4. Container
   1. Engine，表示整个Catalina的servlet引擎，管理多个虚拟站点，这里没理解
   2. Host，代表一个虚拟主机，可以给Tomcat配置多个虚拟主机地址，这里没理解
   3. Context，代表一个web应用程序。
   4. Wrapper，即具体servlet
### 源码
1. Lifecycle接口，由于所有组件均存在初始化、启动、停止等生命周期方法，拥有生命周期管理的特性，因此基于此抽象成该接口。
   1. init()初始化组件
   2. start()启动组件
   3. stop()停止组件
   4. destory()销毁组件
2. 请求处理。Tomcat利用Mapper组件实现：请求交付Wrapper容器的Servlet处理。首先Mapper组件保存了Web应用的配置信息（.xml），包括Host容器配置的域名、Context容器的Web应用路径、以及Wrapper容器的Servlet映射路径。如下图：
   1. 在Tomcat的server.xml的中`<Engine defaultHost="localhost" name="Catalina">`首先查找对应的Host，即定位到的资源是`<Host appBase="webapps" autoDeploy="true" name="localhost" unpackWARs="true">`,因为name=localhost，最终定位到的资源在webapps下面，
   2. 接着，根据URL，定位到具体应用。后面的具体Servlet的定位，则取决于应用的web.xml中的配置信息。
   
      <img src="https://github.com/xuzhuang1996/MyJava/blob/master/img/Tomcat/5.PNG" width=60% height=60% />
